/*! no-unsafe-inline 1.1.0 */
!function(l){"use strict";const u=wp.i18n["__"];function p(n){var e,n=n.split(" ");const t=Array.from(new Set(n)),i=[];for(e=0;e<t.length;e+=1)"'self'"===t[e]&&(i.push("'self'"),t.splice(e,1));for(e=0;e<t.length;e+=1)"http:"===t[e]&&(i.push("http:"),t.splice(e,1));for(e=0;e<t.length;e+=1)"https:"===t[e]&&(i.push("https:"),t.splice(e,1));for(e=0;e<t.length;e+=1)"data:"===t[e]&&(i.push("data:"),t.splice(e,1));for(e=0;e<t.length;e+=1)"mediastream:"===t[e]&&(i.push("mediastream:"),t.splice(e,1));for(e=0;e<t.length;e+=1)"blob:"===t[e]&&(i.push("blob:"),t.splice(e,1));for(e=0;e<t.length;e+=1)"filesystem:"===t[e]&&(i.push("filesystem:"),t.splice(e,1));for(t.sort(),e=0;e<t.length;e+=1)i.push(t[e]);return i.join(" ")}function r(n){var e,t="undefined"!=typeof performance&&performance.now?(e=(performance.now()+performance.timing.navigationStart)/1e3,1e6):(e=(Date.now?Date.now():(new Date).getTime())/1e3,1e3);return n?e:(n=0|e,Math.round((e-n)*t)/t+" "+n)}l.fn.extend({clearText:function(){return this.clone().children().remove().end().text()}});function c(n){for(var e,t=window.location.search.substring(1).split("&"),i=0;i<t.length;i++)if((e=t[i].split("="))[0]===n)return e[1],decodeURIComponent(e[1]);return!1}function d(n){l.ajax({type:"post",dataType:"json",url:nunil_object.ajax_url,data:{action:"nunil_update_summary_tables"},success:function(n){var i="",a="",o="",s="";l.each(n,function(n,e){"global"===n&&l.each(e,function(n,e){i=(i+="<tr>")+'<td data-th="'+u("Type","no-unsafe-inline")+'">'+e.type+"</td>";var t="",t="1"===e.whitelist?u("WL","no-unsafe-inline"):u("BL","no-unsafe-inline");i=(i=(i+='<td data-th="'+u("Whitelist","no-unsafe-inline")+'">'+t+"</td>")+'<td data-th="'+u("Num.","no-unsafe-inline")+'">'+e.num+"</td>")+'<td data-th="'+u("Num. Clusters","no-unsafe-inline")+'">'+e.clusters+"</td></tr>"}),"inline"===n&&l.each(e,function(n,e){o=(o=(o=(o+="<tr>")+'<td data-th="'+u("Directive","no-unsafe-inline")+'">'+e.directive+"</td>")+'<td data-th="'+u("Tagname","no-unsafe-inline")+'">'+e.tagname+"</td>")+'<td data-th="'+u("Cluster","no-unsafe-inline")+'">'+e.clustername+"</td>";var t="",t="1"===e.whitelist?u("WL","no-unsafe-inline"):u("BL","no-unsafe-inline");o=(o+='<td data-th="'+u("Whitelist","no-unsafe-inline")+'">'+t+"</td>")+'<td data-th="'+u("Num.","no-unsafe-inline")+'">'+e.num+"</td></tr>"}),"external"===n&&l.each(e,function(n,e){a=(a=(a=(a+="<tr>")+'<td data-th="'+u("Directive","no-unsafe-inline")+'">'+e.directive+"</td>")+'<td data-th="'+u("Tagname","no-unsafe-inline")+'">'+e.tagname+"</td>")+'<td data-th="'+u("Nonceable","no-unsafe-inline")+'">'+e.nonceable+"</td>";var t="";switch(e.whitelist){case"1":t=u("WL","no-unsafe-inline");break;case"0":t=u("BL","no-unsafe-inline");break;default:t="--"}a=(a+='<td data-th="'+u("Whitelist","no-unsafe-inline")+'">'+t+"</td>")+'<td data-th="'+u("Num.","no-unsafe-inline")+'">'+e.num+"</td></tr>"}),"events"===n&&l.each(e,function(n,e){s=(s=(s=(s+="<tr>")+'<td data-th="'+u("Tagname","no-unsafe-inline")+'">'+e.tagname+"</td>")+'<td data-th="'+u("Event Attribute","no-unsafe-inline")+'">'+e.event_attribute+"</td>")+'<td data-th="'+u("Cluster","no-unsafe-inline")+'">'+e.clustername+"</td>";var t="",t="1"===e.whitelist?u("WL","no-unsafe-inline"):u("BL","no-unsafe-inline");s=(s+='<td data-th="'+u("Whitelist","no-unsafe-inline")+'">'+t+"</td>")+'<td data-th="'+u("Num.","no-unsafe-inline")+'">'+e.num+"</td></tr>"})}),l("#nunil_db_summary_body").html(i),l("#nunil_external_table_summary_body").html(a),l("#nunil_inline_table_summary_body").html(o),l("#nunil_eventhandlers_table_summary_body").html(s)},complete:function(){l("input[type='checkbox'][name='no-unsafe-inline-tools[capture_enabled]']").prop("checked")?void 0===n&&setTimeout(d,25e3):clearTimeout(d)}})}l(window).on("load",function(){l("#nunil-help-link").on("click",function(){l("#contextual-help-link").click()}),l("#cb-select-all-1").on("click",function(){l(":checkbox[name*='bulk-select[]']").prop("checked",this.checked).change()});var n,e=c("page"),t=c("tab");if("no-unsafe-inline"===e&&"base-rule"===t){const a=[],o=[];l("input[type='checkbox'][name*='bulk-select[]']").change(function(){var n=l(this),e=n.parent().parent().find("td:nth-child(2)").clearText(),t=n.parent().parent().find("td:nth-child(3)").clearText(),e="no-unsafe-inline-base-rule\\["+e+"_base_rule\\]";n.prop("checked")?l("#"+e).val(l("#"+e).val()+" "+t):l("#"+e).val(l("#"+e).val().replace(t,"")),l("#"+e).val(p(l("#"+e).val().trim()))}),l("table.nunil-ext-sources tbody").find("tr").each(function(n,e){l(e).find("td").each(function(n,e){e=l(e).clearText();o.push(e)}),a.push([o[0],o[1]]),o.length=0});const s=["base-uri","default-src","script-src","style-src","font-src","img-src","frame-src","media-src","object-src","child-src","connect-src","manifest-src","worker-src","form-action"];s.forEach(function(i){const n=l("#"+("no-unsafe-inline-base-rule\\["+i+"_base_rule\\]")).val().split(" ");n.forEach(function(t){a.forEach(function(n,e){n[0]===i&&n[1]===t&&l("input[type='checkbox'][name*='bulk-select[]'][value='"+(e+1)+"']").prop("checked",!0)})})})}"no-unsafe-inline"!==e||"inline"!==t&&"events"!==t||(n={active:!1,collapsible:!0,animation:200,heightStyle:"content",autoHeight:!1,classes:{"ui-accordion-content":"hljs"}},l("div[class^='code-accordion-']").each(function(){l(this).accordion(n)}),l("div[class^='pages-accordion-']").each(function(){l(this).accordion(n)}));let i;i=l("#nunil-endpoints-list li").length,l("input[type='text'][name='no-unsafe-inline[max_response_header_size]']").spinner({min:512,max:24576,numberFormat:"n",page:5,step:512,classes:{"ui-spinner":"highlight"}}),"no-unsafe-inline"===e&&"settings"===t&&(l("input[type='checkbox'][name='no-unsafe-inline[sri_script]']").change(function(){l(this).prop("checked")&&!1===l("input[type='checkbox'][name='no-unsafe-inline[sri_sha256]']").prop("checked")&&!1===l("input[type='checkbox'][name='no-unsafe-inline[sri_sha384]']").prop("checked")&&!1===l("input[type='checkbox'][name='no-unsafe-inline[sri_sha512]']").prop("checked")&&l("input[type='checkbox'][name='no-unsafe-inline[sri_sha256]']").prop("checked",!0)}),l("input[type='checkbox'][name='no-unsafe-inline[sri_link]']").change(function(){l(this).prop("checked")&&!1===l("input[type='checkbox'][name='no-unsafe-inline[sri_sha256]']").prop("checked")&&!1===l("input[type='checkbox'][name='no-unsafe-inline[sri_sha384]']").prop("checked")&&!1===l("input[type='checkbox'][name='no-unsafe-inline[sri_sha512]']").prop("checked")&&l("input[type='checkbox'][name='no-unsafe-inline[sri_sha256]']").prop("checked",!0)}),l("input[type='checkbox'][name='no-unsafe-inline[use_reports]']").prop("checked")||(l("input[type='text'][name='no-unsafe-inline[group_name]']").prop("disabled",!0),l("input[type='text'][name='no-unsafe-inline[max_age]']").prop("disabled",!0),l("input[type='button'][name='no-unsafe-inline[add_new_endpoint]']").prop("disabled",!0),l("input[type='text'][name='no-unsafe-inline[new_endpoint]']").prop("disabled",!0),l(".nunil-btn-del-endpoint").prop("disabled",!0),l(".nunil-hidden-endpoint").prop("disabled",!0),l(".nunil-endpoint-string").removeClass("txt-active"),l(".nunil-endpoint-string").addClass("txt-inactive")),l("input[type='checkbox'][name='no-unsafe-inline[use_reports]']").change(function(){l(this).prop("checked")?(l("input[type='text'][name='no-unsafe-inline[group_name]']").prop("disabled",!1),l("input[type='text'][name='no-unsafe-inline[max_age]']").prop("disabled",!1),l("input[type='button'][name='no-unsafe-inline[add_new_endpoint]']").prop("disabled",!1),l("input[type='text'][name='no-unsafe-inline[new_endpoint]']").prop("disabled",!1),l(".nunil-btn-del-endpoint").prop("disabled",!1),l(".nunil-hidden-endpoint").prop("disabled",!1),l(".nunil-endpoint-string").removeClass("txt-inactive"),l(".nunil-endpoint-string").addClass("txt-active")):(l("input[type='text'][name='no-unsafe-inline[group_name]']").prop("disabled",!0),l("input[type='text'][name='no-unsafe-inline[max_age]']").prop("disabled",!0),l("input[type='button'][name='no-unsafe-inline[add_new_endpoint]']").prop("disabled",!0),l("input[type='text'][name='no-unsafe-inline[new_endpoint]']").prop("disabled",!0),l(".nunil-btn-del-endpoint").prop("disabled",!0),l(".nunil-hidden-endpoint").prop("disabled",!0),l(".nunil-endpoint-string").removeClass("txt-active"),l(".nunil-endpoint-string").addClass("txt-inactive"))}),l("#nunil-endpoints-list").on("click",".nunil-btn-del-endpoint",function(){l(this).closest("li").remove()}),l("input[type='text'][name='no-unsafe-inline[new_endpoint]']").focus(function(){l(this).removeClass("nunil-error-input")}),l("input[type='button'][name='no-unsafe-inline[add_new_endpoint]']").click(function(){var n;!function(n){let e;try{e=new URL(n)}catch(n){return}return"http:"===e.protocol||"https:"===e.protocol}(l("input[type='text'][name='no-unsafe-inline[new_endpoint]']").val())?l("input[type='text'][name='no-unsafe-inline[new_endpoint]']").addClass("nunil-error-input"):(n=l("input[type='text'][name='no-unsafe-inline[new_endpoint]']").val().trim(),l("#nunil-endpoints-list").append('<li><input  class="nunil-btn nunil-btn-del-endpoint" type="button" id="no-unsafe-inline[del-endpoint]['+i+']" name="no-unsafe-inline[del-endpoint]['+i+']" value="&#x2425;"><span class="nunil-endpoint-string txt-active txt-newly">'+n+'</span><input class="nunil-hidden-endpoint" type="hidden" id="no-unsafe-inline[endpoints]['+i+']"name="no-unsafe-inline[endpoints]['+i+']" value="'+n+'" /></li>'),l("input[type='text'][name='no-unsafe-inline[new_endpoint]']").val(""),l("input[type='text'][name='no-unsafe-inline[new_endpoint]']").removeClass("nunil-error-input"),i+=1)})),l("#nunil-db-sum-tabs").tabs({active:!1,collapsible:!0,classes:{"ui-tabs":"ui-corner-none","ui-tabs-nav":"ui-corner-none","ui-tabs-tab":"ui-corner-none","ui-tabs-panel":"ui-corner-none"}}),l("#nunil_trigger_clustering").click(function(n){n.preventDefault(),l("#nunil_trigger_clustering").prop("disabled",!0);n=l("#clustering_nonce").val();l.ajax({type:"post",dataType:"json",url:nunil_object.ajax_url,data:{action:"nunil_trigger_clustering",nonce:n},beforeSend:function(){l("#nunil-spinner-blocks").removeClass("hidden")},success:function(n){"success"===n.type?(l("div#nunil_tools_operation_report").append(n.report),l("#nunil_trigger_clustering").prop("disabled",!1),d("once")):(l("div#nunil_tools_operation_report").append(r(!0)+u("Error in clustering scripts.","no-unsafe-inline")+"<br>"),l("#nunil_trigger_clustering").prop("disabled",!1))},complete:function(){l("#nunil-spinner-blocks").addClass("hidden")}})}),l("#nunil_test_classifier").click(function(n){n.preventDefault(),l("#nunil_test_classifier").prop("disabled",!0);n=l("#test_clussifier_nonce").val();l.ajax({type:"post",dataType:"json",url:nunil_object.ajax_url,data:{action:"nunil_test_classifier",nonce:n},beforeSend:function(){l("#nunil-spinner-blocks").removeClass("hidden")},success:function(n){"success"===n.type?l("div#nunil_tools_operation_report").append(n.report):l("div#nunil_tools_operation_report").append(r(!0)+u("Error in test classifier scripts.","no-unsafe-inline")+"<br>"),l("#nunil_test_classifier").prop("disabled",!1)},complete:function(){l("#nunil-spinner-blocks").addClass("hidden")}})}),l("#nunil_clean_database").click(function(n){if(!window.confirm(u("Are you sure you want to clean db data?\n(This will not clear your base rules)","no-unsafe-inline")))return!1;n.preventDefault(),l("#nunil_clean_database").prop("disabled",!0);n=l("#clean_db_nonce").val();l.ajax({type:"post",dataType:"json",url:nunil_object.ajax_url,data:{action:"nunil_clean_database",nonce:n},beforeSend:function(){l("#nunil-spinner-blocks").removeClass("hidden")},success:function(n){"success"===n.type?(l("div#nunil_tools_operation_report").append(n.report),l("#nunil_clean_database").prop("disabled",!1),d("once")):(l("div#nunil_tools_operation_report").append(r(!0)+u("Error in cleaning tables.","no-unsafe-inline")+"<br>"),l("#nunil_clean_database").prop("disabled",!1))},complete:function(){l("#nunil-spinner-blocks").addClass("hidden")}})}),l("#nunil_prune_database").click(function(n){if(!window.confirm(u("Are you sure you want to prune db data?\n(This will reduce cluster size and remove orphans entries from occurences table)","no-unsafe-inline")))return!1;n.preventDefault(),l("#nunil_prune_database").prop("disabled",!0);n=l("#prune_db_nonce").val();l.ajax({type:"post",dataType:"json",url:nunil_object.ajax_url,data:{action:"nunil_prune_database",nonce:n},beforeSend:function(){l("#nunil-spinner-blocks").removeClass("hidden")},success:function(n){"success"===n.type?(l("div#nunil_tools_operation_report").append(n.report),l("#nunil_prune_database").prop("disabled",!1),d("once")):(l("div#nunil_tools_operation_report").append(r(!0)+u("Error in pruning tables.","no-unsafe-inline")+"<br>"),l("#nunil_prune_database").prop("disabled",!1))},complete:function(){l("#nunil-spinner-blocks").addClass("hidden")}})}),"no-unsafe-inline"!==e||"tools"!==t&&null!==t&&!1!==t||(l("input#submit").prop("disabled",!0),l("input[type='checkbox'][name='no-unsafe-inline-tools[capture_enabled]']").prop("checked")&&d()),l("input[type='checkbox'][name='no-unsafe-inline-tools[capture_enabled]']").change(function(){l("input#submit").prop("disabled",!1),l(this).prop("checked")&&d()}),l("input[type='checkbox'][name='no-unsafe-inline-tools[test_policy]']").change(function(){l("input#submit").prop("disabled",!1),l(this).prop("checked")&&l("input[type='checkbox'][name='no-unsafe-inline-tools[enable_protection]']").prop("checked",!1)}),l("input[type='checkbox'][name='no-unsafe-inline-tools[enable_protection]']").change(function(){l("input#submit").prop("disabled",!1),l(this).prop("checked")&&l("input[type='checkbox'][name='no-unsafe-inline-tools[test_policy]']").prop("checked",!1)})})}(jQuery);