/*! no-unsafe-inline 1.1.0 */
jQuery(document).ready(function(l){"use strict";function n(n){for(var e,t=window.location.search.substring(1).split("&"),i=0;i<t.length;i+=1)if((e=t[i].split("="))[0]===n)return void 0===e[1]||decodeURIComponent(e[1]);return!1}n("page"),n("tab");var e,t,i,a,o=l("table.nunil-ext-sources tbody");const u=wp.i18n["__"];function s(n){for(var n=n.split(" "),e=Array.from(new Set(n)),t=[],i=0;i<e.length;i+=1)"'self'"===e[i]&&(t.push("'self'"),e.splice(i,1));for(i=0;i<e.length;i+=1)"http:"===e[i]&&(t.push("http:"),e.splice(i,1));for(i=0;i<e.length;i+=1)"https:"===e[i]&&(t.push("https:"),e.splice(i,1));for(i=0;i<e.length;i+=1)"data:"===e[i]&&(t.push("data:"),e.splice(i,1));for(i=0;i<e.length;i+=1)"mediastream:"===e[i]&&(t.push("mediastream:"),e.splice(i,1));for(i=0;i<e.length;i+=1)"blob:"===e[i]&&(t.push("blob:"),e.splice(i,1));for(i=0;i<e.length;i+=1)"filesystem:"===e[i]&&(t.push("filesystem:"),e.splice(i,1));for(e.sort(),i=0;i<e.length;i+=1)t.push(e[i]);return t.join(" ")}function p(n){var e,t=void 0!==performance&&performance.now?(e=(performance.now()+performance.timing.navigationStart)/1e3,1e6):(e=(Date.now?Date.now():(new Date).getTime())/1e3,1e3);return n?e:(n=0|e,Math.round((e-n)*t)/t+" "+n)}function r(n){l.ajax({complete:function(){l("input[type='checkbox'][name='no-unsafe-inline-tools[capture_enabled]']").prop("checked")?void 0===n&&setTimeout(r,25e3):clearTimeout(r)},data:{action:"nunil_update_summary_tables"},dataType:"json",success:function(n){var i="",a="",o="",s="";l.each(n,function(n,e){"global"===n&&l.each(e,function(n,e){var t="";i=(i+="<tr>")+'<td data-th="'+u("Type","no-unsafe-inline")+'">'+e.type+"</td>",t="1"===e.whitelist?u("WL","no-unsafe-inline"):u("BL","no-unsafe-inline"),i=(i=(i+='<td data-th="'+u("Whitelist","no-unsafe-inline")+'">'+t+"</td>")+'<td data-th="'+u("Num.","no-unsafe-inline")+'">'+e.num+"</td>")+'<td data-th="'+u("Num. Clusters","no-unsafe-inline")+'">'+e.clusters+"</td></tr>"}),"inline"===n&&l.each(e,function(n,e){var t="";o=(o=(o=(o+="<tr>")+'<td data-th="'+u("Directive","no-unsafe-inline")+'">'+e.directive+"</td>")+'<td data-th="'+u("Tagname","no-unsafe-inline")+'">'+e.tagname+"</td>")+'<td data-th="'+u("Cluster","no-unsafe-inline")+'">'+e.clustername+"</td>",t="1"===e.whitelist?u("WL","no-unsafe-inline"):u("BL","no-unsafe-inline"),o=(o+='<td data-th="'+u("Whitelist","no-unsafe-inline")+'">'+t+"</td>")+'<td data-th="'+u("Num.","no-unsafe-inline")+'">'+e.num+"</td></tr>"}),"external"===n&&l.each(e,function(n,e){var t="";switch(a=(a=(a=(a+="<tr>")+('<td data-th="'+u("Directive","no-unsafe-inline")+'">'+e.directive+"</td>"))+('<td data-th="'+u("Tagname","no-unsafe-inline")+'">'+e.tagname+"</td>"))+('<td data-th="'+u("Nonceable","no-unsafe-inline")+'">'+e.nonceable+"</td>"),e.whitelist){case"1":t=u("WL","no-unsafe-inline");break;case"0":t=u("BL","no-unsafe-inline");break;default:t="--"}a=(a+='<td data-th="'+u("Whitelist","no-unsafe-inline")+'">'+t+"</td>")+'<td data-th="'+u("Num.","no-unsafe-inline")+'">'+e.num+"</td></tr>"}),"events"===n&&l.each(e,function(n,e){var t="";s=(s=(s=(s+="<tr>")+'<td data-th="'+u("Tagname","no-unsafe-inline")+'">'+e.tagname+"</td>")+'<td data-th="'+u("Event Attribute","no-unsafe-inline")+'">'+e.event_attribute+"</td>")+'<td data-th="'+u("Cluster","no-unsafe-inline")+'">'+e.clustername+"</td>",t="1"===e.whitelist?u("WL","no-unsafe-inline"):u("BL","no-unsafe-inline"),s=(s+='<td data-th="'+u("Whitelist","no-unsafe-inline")+'">'+t+"</td>")+'<td data-th="'+u("Num.","no-unsafe-inline")+'">'+e.num+"</td></tr>"})}),l("#nunil_db_summary_body").html(i),l("#nunil_external_table_summary_body").html(a),l("#nunil_inline_table_summary_body").html(o),l("#nunil_eventhandlers_table_summary_body").html(s)},type:"post",url:nunil_object.ajax_url})}if(l.fn.extend({clearText:function(){return this.clone().children().remove().end().text()}}),l("#nunil-help-link").on("click",function(){l("#contextual-help-link").click()}),l("#cb-select-all-1").on("click",function(){l(":checkbox[name*='bulk-select[]']").prop("checked",this.checked).change()}),i=n("page"),a=n("tab"),o=l("table.nunil-ext-sources tbody"),"no-unsafe-inline"===i&&"base-rule"===a){const c=[],d=[];l("input[type='checkbox'][name*='bulk-select[]']").on("change",function(){var n=l(this),e=n.parent().parent().find("td:nth-child(2)").clearText(),t=n.parent().parent().find("td:nth-child(3)").clearText(),e="no-unsafe-inline-base-rule\\["+e+"_base_rule\\]";n.prop("checked")?l("#"+e).val(l("#"+e).val()+" "+t):l("#"+e).val(l("#"+e).val().replace(t,"")),l("#"+e).val(s(l("#"+e).val().trim()))}),o.find("tr").each(function(n,e){l(e).find("td").each(function(n,e){e=l(e).clearText();d.push(e)}),c.push([d[0],d[1]]),d.length=0}),["base-uri","default-src","script-src","style-src","font-src","img-src","frame-src","media-src","object-src","connect-src","manifest-src","worker-src","form-action"].forEach(function(i){l("#"+("no-unsafe-inline-base-rule\\["+i+"_base_rule\\]")).val().split(" ").forEach(function(t){c.forEach(function(n,e){n[0]===i&&n[1]===t&&l("input[type='checkbox'][name*='bulk-select[]'][value='"+(e+1)+"']").prop("checked",!0)})})})}"no-unsafe-inline"!==i||"inline"!==a&&"events"!==a||(t={active:!1,animation:200,autoHeight:!1,classes:{"ui-accordion-content":"hljs"},collapsible:!0,heightStyle:"content"},l("div[class^='code-accordion-']").each(function(){l(this).accordion(t)}),l("div[class^='pages-accordion-']").each(function(){l(this).accordion(t)})),e=l("#nunil-endpoints-list li").length,l("input[type='text'][name='no-unsafe-inline[max_response_header_size]']").spinner({classes:{"ui-spinner":"highlight"},max:24576,min:512,numberFormat:"n",page:5,step:512}),"no-unsafe-inline"===i&&"settings"===a&&(l("input[type='checkbox'][name='no-unsafe-inline[sri_script]']").on("change",function(){l(this).prop("checked")&&!1===l("input[type='checkbox'][name='no-unsafe-inline[sri_sha256]']").prop("checked")&&!1===l("input[type='checkbox'][name='no-unsafe-inline[sri_sha384]']").prop("checked")&&!1===l("input[type='checkbox'][name='no-unsafe-inline[sri_sha512]']").prop("checked")&&l("input[type='checkbox'][name='no-unsafe-inline[sri_sha256]']").prop("checked",!0)}),l("input[type='checkbox'][name='no-unsafe-inline[sri_link]']").on("change",function(){l(this).prop("checked")&&!1===l("input[type='checkbox'][name='no-unsafe-inline[sri_sha256]']").prop("checked")&&!1===l("input[type='checkbox'][name='no-unsafe-inline[sri_sha384]']").prop("checked")&&!1===l("input[type='checkbox'][name='no-unsafe-inline[sri_sha512]']").prop("checked")&&l("input[type='checkbox'][name='no-unsafe-inline[sri_sha256]']").prop("checked",!0)}),l("input[type='checkbox'][name='no-unsafe-inline[use_reports]']").prop("checked")||(l("input[type='text'][name='no-unsafe-inline[group_name]']").prop("disabled",!0),l("input[type='text'][name='no-unsafe-inline[max_age]']").prop("disabled",!0),l("input[type='button'][name='no-unsafe-inline[add_new_endpoint]']").prop("disabled",!0),l("input[type='text'][name='no-unsafe-inline[new_endpoint]']").prop("disabled",!0),l(".nunil-btn-del-endpoint").prop("disabled",!0),l(".nunil-hidden-endpoint").prop("disabled",!0),l(".nunil-endpoint-string").removeClass("txt-active"),l(".nunil-endpoint-string").addClass("txt-inactive")),l("input[type='checkbox'][name='no-unsafe-inline[use_reports]']").on("change",function(){l(this).prop("checked")?(l("input[type='text'][name='no-unsafe-inline[group_name]']").prop("disabled",!1),l("input[type='text'][name='no-unsafe-inline[max_age]']").prop("disabled",!1),l("input[type='button'][name='no-unsafe-inline[add_new_endpoint]']").prop("disabled",!1),l("input[type='text'][name='no-unsafe-inline[new_endpoint]']").prop("disabled",!1),l(".nunil-btn-del-endpoint").prop("disabled",!1),l(".nunil-hidden-endpoint").prop("disabled",!1),l(".nunil-endpoint-string").removeClass("txt-inactive"),l(".nunil-endpoint-string").addClass("txt-active")):(l("input[type='text'][name='no-unsafe-inline[group_name]']").prop("disabled",!0),l("input[type='text'][name='no-unsafe-inline[max_age]']").prop("disabled",!0),l("input[type='button'][name='no-unsafe-inline[add_new_endpoint]']").prop("disabled",!0),l("input[type='text'][name='no-unsafe-inline[new_endpoint]']").prop("disabled",!0),l(".nunil-btn-del-endpoint").prop("disabled",!0),l(".nunil-hidden-endpoint").prop("disabled",!0),l(".nunil-endpoint-string").removeClass("txt-active"),l(".nunil-endpoint-string").addClass("txt-inactive"))}),l("#nunil-endpoints-list").on("click",".nunil-btn-del-endpoint",function(){l(this).closest("li").remove()}),l("input[type='text'][name='no-unsafe-inline[new_endpoint]']").on("focus",function(){l(this).removeClass("nunil-error-input")}),l("input[type='button'][name='no-unsafe-inline[add_new_endpoint]']").on("click",function(){var n;!function(n){var e;try{e=new URL(n)}catch(n){return}return"http:"===e.protocol||"https:"===e.protocol}(l("input[type='text'][name='no-unsafe-inline[new_endpoint]']").val())?l("input[type='text'][name='no-unsafe-inline[new_endpoint]']").addClass("nunil-error-input"):(n=l("input[type='text'][name='no-unsafe-inline[new_endpoint]']").val().trim(),l("#nunil-endpoints-list").append('<li><input  class="nunil-btn nunil-btn-del-endpoint" type="button" id="no-unsafe-inline[del-endpoint]['+e+']" name="no-unsafe-inline[del-endpoint]['+e+']" value="&#x2425;"><span class="nunil-endpoint-string txt-active txt-newly">'+n+'</span><input class="nunil-hidden-endpoint" type="hidden" id="no-unsafe-inline[endpoints]['+e+']"name="no-unsafe-inline[endpoints]['+e+']" value="'+n+'" /></li>'),l("input[type='text'][name='no-unsafe-inline[new_endpoint]']").val(""),l("input[type='text'][name='no-unsafe-inline[new_endpoint]']").removeClass("nunil-error-input"),e+=1)})),l("#nunil-db-sum-tabs").tabs({active:!1,classes:{"ui-tabs":"ui-corner-none","ui-tabs-nav":"ui-corner-none","ui-tabs-panel":"ui-corner-none","ui-tabs-tab":"ui-corner-none"},collapsible:!0}),l("#nunil_trigger_clustering").on("click",function(n){var e=l("#clustering_nonce").val();n.preventDefault(),l("#nunil_trigger_clustering").prop("disabled",!0),l.ajax({beforeSend:function(){l("#nunil-spinner-blocks").removeClass("hidden")},complete:function(){l("#nunil-spinner-blocks").addClass("hidden")},data:{action:"nunil_trigger_clustering",nonce:e},dataType:"json",success:function(n){"success"===n.type?(l("div#nunil_tools_operation_report").append(n.report),l("#nunil_trigger_clustering").prop("disabled",!1),r("once")):(l("div#nunil_tools_operation_report").append(p(!0)+u("Error in clustering scripts.","no-unsafe-inline")+"<br>"),l("#nunil_trigger_clustering").prop("disabled",!1))},type:"post",url:nunil_object.ajax_url})}),l("#nunil_test_classifier").on("click",function(n){var e=l("#test_clussifier_nonce").val();n.preventDefault(),l("#nunil_test_classifier").prop("disabled",!0),l.ajax({beforeSend:function(){l("#nunil-spinner-blocks").removeClass("hidden")},complete:function(){l("#nunil-spinner-blocks").addClass("hidden")},data:{action:"nunil_test_classifier",nonce:e},dataType:"json",success:function(n){"success"===n.type?l("div#nunil_tools_operation_report").append(n.report):l("div#nunil_tools_operation_report").append(p(!0)+u("Error in test classifier scripts.","no-unsafe-inline")+"<br>"),l("#nunil_test_classifier").prop("disabled",!1)},type:"post",url:nunil_object.ajax_url})}),l("#nunil_clean_database").on("click",function(n){var e=l("#clean_db_nonce").val();if(!window.confirm(u("Are you sure you want to clean db data?\n(This will not clear your base rules)","no-unsafe-inline")))return!1;n.preventDefault(),l("#nunil_clean_database").prop("disabled",!0),l.ajax({beforeSend:function(){l("#nunil-spinner-blocks").removeClass("hidden")},complete:function(){l("#nunil-spinner-blocks").addClass("hidden")},data:{action:"nunil_clean_database",nonce:e},dataType:"json",success:function(n){"success"===n.type?(l("div#nunil_tools_operation_report").append(n.report),l("#nunil_clean_database").prop("disabled",!1),r("once")):(l("div#nunil_tools_operation_report").append(p(!0)+u("Error in cleaning tables.","no-unsafe-inline")+"<br>"),l("#nunil_clean_database").prop("disabled",!1))},type:"post",url:nunil_object.ajax_url})}),l("#nunil_prune_database").on("click",function(n){var e=l("#prune_db_nonce").val();if(!window.confirm(u("Are you sure you want to prune db data?\n(This will reduce cluster size and remove orphans entries from occurences table)","no-unsafe-inline")))return!1;n.preventDefault(),l("#nunil_prune_database").prop("disabled",!0),l.ajax({beforeSend:function(){l("#nunil-spinner-blocks").removeClass("hidden")},complete:function(){l("#nunil-spinner-blocks").addClass("hidden")},data:{action:"nunil_prune_database",nonce:e},dataType:"json",success:function(n){"success"===n.type?(l("div#nunil_tools_operation_report").append(n.report),l("#nunil_prune_database").prop("disabled",!1),r("once")):(l("div#nunil_tools_operation_report").append(p(!0)+u("Error in pruning tables.","no-unsafe-inline")+"<br>"),l("#nunil_prune_database").prop("disabled",!1))},type:"post",url:nunil_object.ajax_url})}),"no-unsafe-inline"!==i||"tools"!==a&&null!==a&&!1!==a||(l("input#submit").prop("disabled",!0),l("input[type='checkbox'][name='no-unsafe-inline-tools[capture_enabled]']").prop("checked")&&r()),l("input[type='checkbox'][name='no-unsafe-inline-tools[capture_enabled]']").on("change",function(){var n=l(this);l("input#submit").prop("disabled",!1),n.prop("checked")&&r()}),l("input[type='checkbox'][name='no-unsafe-inline-tools[test_policy]']").on("change",function(){var n=l(this);l("input#submit").prop("disabled",!1),n.prop("checked")&&l("input[type='checkbox'][name='no-unsafe-inline-tools[enable_protection]']").prop("checked",!1)}),l("input[type='checkbox'][name='no-unsafe-inline-tools[enable_protection]']").on("change",function(){var n=l(this);l("input#submit").prop("disabled",!1),n.prop("checked")&&l("input[type='checkbox'][name='no-unsafe-inline-tools[test_policy]']").prop("checked",!1)})});