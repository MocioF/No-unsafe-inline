/*! no-unsafe-inline 1.2.2 */
jQuery(document).ready(function(s){function n(n){for(var e,t=window.location.search.substring(1).split("&"),i=0;i<t.length;i+=1)if((e=t[i].split("="))[0]===n)return void 0===e[1]||decodeURIComponent(e[1]);return!1}n("page"),n("tab");var e,t,i,o,a=s("table.nunil-ext-sources tbody");let r=wp.i18n.__;function l(n){for(var n=n.split(" "),e=Array.from(new Set(n)),t=[],i=0;i<e.length;i+=1)"'self'"===e[i]&&(t.push("'self'"),e.splice(i,1));for(i=0;i<e.length;i+=1)"http:"===e[i]&&(t.push("http:"),e.splice(i,1));for(i=0;i<e.length;i+=1)"https:"===e[i]&&(t.push("https:"),e.splice(i,1));for(i=0;i<e.length;i+=1)"data:"===e[i]&&(t.push("data:"),e.splice(i,1));for(i=0;i<e.length;i+=1)"mediastream:"===e[i]&&(t.push("mediastream:"),e.splice(i,1));for(i=0;i<e.length;i+=1)"blob:"===e[i]&&(t.push("blob:"),e.splice(i,1));for(i=0;i<e.length;i+=1)"filesystem:"===e[i]&&(t.push("filesystem:"),e.splice(i,1));for(e.sort(),i=0;i<e.length;i+=1)t.push(e[i]);return t.join(" ")}function p(n){var e,t=void 0!==performance&&performance.now?(e=(performance.now()+performance.timing.navigationStart)/1e3,1e6):(e=(Date.now?Date.now():(new Date).getTime())/1e3,1e3);return n?e:(n=0|e,Math.round((e-n)*t)/t+" "+n)}function u(n){s.ajax({complete:function(){s("input[type='checkbox'][name='no-unsafe-inline-tools[capture_enabled]']").prop("checked")?void 0===n&&setTimeout(u,25e3):clearTimeout(u)},data:{action:"nunil_update_summary_tables"},dataType:"json",success:function(n){var i="",o="",a="",l="";s.each(n,function(n,e){"global"===n&&s.each(e,function(n,e){var t="";i=(i+="<tr>")+'<td data-th="'+r("Type","no-unsafe-inline")+'">'+e.type+"</td>",t="1"===e.whitelist?r("WL","no-unsafe-inline"):r("BL","no-unsafe-inline"),i=(i=(i+='<td data-th="'+r("Whitelist","no-unsafe-inline")+'">'+t+"</td>")+'<td data-th="'+r("Num.","no-unsafe-inline")+'">'+e.num+"</td>")+'<td data-th="'+r("Num. Clusters","no-unsafe-inline")+'">'+e.clusters+"</td></tr>"}),"inline"===n&&s.each(e,function(n,e){var t="";a=(a=(a=(a+="<tr>")+'<td data-th="'+r("Directive","no-unsafe-inline")+'">'+e.directive+"</td>")+'<td data-th="'+r("Tagname","no-unsafe-inline")+'">'+e.tagname+"</td>")+'<td data-th="'+r("Cluster","no-unsafe-inline")+'">'+e.clustername+"</td>",t="1"===e.whitelist?r("WL","no-unsafe-inline"):r("BL","no-unsafe-inline"),a=(a+='<td data-th="'+r("Whitelist","no-unsafe-inline")+'">'+t+"</td>")+'<td data-th="'+r("Num.","no-unsafe-inline")+'">'+e.num+"</td></tr>"}),"external"===n&&s.each(e,function(n,e){var t="";switch(o=(o=(o=(o+="<tr>")+('<td data-th="'+r("Directive","no-unsafe-inline")+'">'+e.directive+"</td>"))+('<td data-th="'+r("Tagname","no-unsafe-inline")+'">'+e.tagname+"</td>"))+('<td data-th="'+r("Nonceable","no-unsafe-inline")+'">'+e.nonceable+"</td>"),e.whitelist){case"1":t=r("WL","no-unsafe-inline");break;case"0":t=r("BL","no-unsafe-inline");break;default:t="--"}o=(o+='<td data-th="'+r("Whitelist","no-unsafe-inline")+'">'+t+"</td>")+'<td data-th="'+r("Num.","no-unsafe-inline")+'">'+e.num+"</td></tr>"}),"events"===n&&s.each(e,function(n,e){var t="";l=(l=(l=(l+="<tr>")+'<td data-th="'+r("Tagname","no-unsafe-inline")+'">'+e.tagname+"</td>")+'<td data-th="'+r("Event Attribute","no-unsafe-inline")+'">'+e.event_attribute+"</td>")+'<td data-th="'+r("Cluster","no-unsafe-inline")+'">'+e.clustername+"</td>",t="1"===e.whitelist?r("WL","no-unsafe-inline"):r("BL","no-unsafe-inline"),l=(l+='<td data-th="'+r("Whitelist","no-unsafe-inline")+'">'+t+"</td>")+'<td data-th="'+r("Num.","no-unsafe-inline")+'">'+e.num+"</td></tr>"})}),s("#nunil_db_summary_body").html(i),s("#nunil_external_table_summary_body").html(o),s("#nunil_inline_table_summary_body").html(a),s("#nunil_eventhandlers_table_summary_body").html(l)},type:"post",url:nunil_object.ajax_url})}function c(n){var e=s("div.copy-notification");0==e.length&&(e=s("<div/>",{class:"ui-tooltip ui-corner-all ui-widget-shadow ui-widget ui-widget-content copy-notification",text:n}),s("#nunil_tools_operation_report_container").append(e),e.fadeIn("slow",function(){setTimeout(function(){e.fadeOut("slow",function(){e.remove()})},1e3)}))}if(s.fn.extend({clearText:function(){return this.clone().children().remove().end().text()}}),s("#nunil-help-link").on("click",function(){s("#contextual-help-link").click()}),s("#cb-select-all-1").on("click",function(){s(":checkbox[name*='bulk-select[]']").prop("checked",this.checked).change()}),s("#nunil-db-sum-tabs-5").on("mouseenter",function(){s("#nunil_tools_operation_report_buttons").stop(!0).fadeIn(600)}),s("#nunil-db-sum-tabs-5").on("mouseleave",function(){s("#nunil_tools_operation_report_buttons").stop(!0).fadeOut(600)}),s("#nunil_tools_operation_report_button_clipboard").tooltip({position:{at:"right center",my:"left+15 center"}}),s("#nunil_tools_operation_report_button_clear").tooltip({position:{at:"right center",my:"left+15 center"}}),s("#nunil_tools_operation_report_button_clipboard").on("click",function(n){n.preventDefault();var n=s("#nunil_tools_operation_report").text(),e=!0,t=s(this).data("notification"),i=s("<textarea>");s("body").append(i),i.val(n).trigger("select"),document.execCommand("copy"),i.remove(),void 0===t&&(t="Copied to clipboard"),(e=void 0===e?!0:e)&&c(t)}),s("#nunil_tools_operation_report_button_clear").on("click",function(n,e=s(this).data("notification"),t=s(this).data("dialog-message")){n.preventDefault();var i=s("div.nunil-tools-dialog"),i=s("<div/>",{class:"nunil-tools-dialog",text:t});s("#nunil_tools_operation_report_container").append(i),s(".nunil-tools-dialog").dialog({buttons:{Ok:function(){s(this).dialog("close"),i.remove(),s("#nunil_tools_operation_report").text(""),c(e)},Cancel:function(){s(this).dialog("close"),i.remove()}},dialogClass:"no-titlebar",height:"auto",modal:!0,resizable:!1})}),i=n("page"),o=n("tab"),a=s("table.nunil-ext-sources tbody"),"no-unsafe-inline"===i&&"base-rule"===o){let o=[],t=[];s("input[type='checkbox'][name*='bulk-select[]']").on("change",function(){var n=s(this),e=n.parent().parent().find("td:nth-child(2)").clearText(),t=n.parent().parent().find("td:nth-child(3)").clearText(),e="no-unsafe-inline-base-rule\\["+e+"_base_rule\\]";n.prop("checked")?s("#"+e).val(s("#"+e).val()+" "+t):s("#"+e).val(s("#"+e).val().replace(t,"")),s("#"+e).val(l(s("#"+e).val().trim()))}),a.find("tr").each(function(n,e){s(e).find("td").each(function(n,e){e=s(e).clearText();t.push(e)}),o.push([t[0],t[1]]),t.length=0}),["base-uri","default-src","script-src","style-src","font-src","img-src","frame-src","media-src","object-src","connect-src","manifest-src","worker-src","form-action"].forEach(function(i){s("#"+("no-unsafe-inline-base-rule\\["+i+"_base_rule\\]")).val().split(" ").forEach(function(t){o.forEach(function(n,e){n[0]===i&&n[1]===t&&s("input[type='checkbox'][name*='bulk-select[]'][value='"+(e+1)+"']").prop("checked",!0)})})})}"no-unsafe-inline"!==i||"inline"!==o&&"events"!==o||(t={active:!1,animation:200,autoHeight:!1,classes:{"ui-accordion-content":"hljs"},collapsible:!0,heightStyle:"content"},s("div[class^='code-accordion-']").each(function(){s(this).accordion(t)}),s("div[class^='pages-accordion-']").each(function(){s(this).accordion(t)})),e=s("#nunil-endpoints-list li").length,s("input[type='text'][name='no-unsafe-inline[max_response_header_size]']").spinner({classes:{"ui-spinner":"highlight"},max:24576,min:512,numberFormat:"n",page:5,step:512}),"no-unsafe-inline"===i&&"settings"===o&&(s("input[type='checkbox'][name='no-unsafe-inline[sri_script]']").on("change",function(){s(this).prop("checked")&&!1===s("input[type='checkbox'][name='no-unsafe-inline[sri_sha256]']").prop("checked")&&!1===s("input[type='checkbox'][name='no-unsafe-inline[sri_sha384]']").prop("checked")&&!1===s("input[type='checkbox'][name='no-unsafe-inline[sri_sha512]']").prop("checked")&&s("input[type='checkbox'][name='no-unsafe-inline[sri_sha256]']").prop("checked",!0)}),s("input[type='checkbox'][name='no-unsafe-inline[sri_link]']").on("change",function(){s(this).prop("checked")&&!1===s("input[type='checkbox'][name='no-unsafe-inline[sri_sha256]']").prop("checked")&&!1===s("input[type='checkbox'][name='no-unsafe-inline[sri_sha384]']").prop("checked")&&!1===s("input[type='checkbox'][name='no-unsafe-inline[sri_sha512]']").prop("checked")&&s("input[type='checkbox'][name='no-unsafe-inline[sri_sha256]']").prop("checked",!0)}),s("input[type='checkbox'][name='no-unsafe-inline[use_reports]']").prop("checked")||(s("input[type='text'][name='no-unsafe-inline[group_name]']").prop("disabled",!0),s("input[type='text'][name='no-unsafe-inline[max_age]']").prop("disabled",!0),s("input[type='button'][name='no-unsafe-inline[add_new_endpoint]']").prop("disabled",!0),s("input[type='text'][name='no-unsafe-inline[new_endpoint]']").prop("disabled",!0),s(".nunil-btn-del-endpoint").prop("disabled",!0),s(".nunil-hidden-endpoint").prop("disabled",!0),s(".nunil-endpoint-string").removeClass("txt-active"),s(".nunil-endpoint-string").addClass("txt-inactive")),s("input[type='checkbox'][name='no-unsafe-inline[use_reports]']").on("change",function(){s(this).prop("checked")?(s("input[type='text'][name='no-unsafe-inline[group_name]']").prop("disabled",!1),s("input[type='text'][name='no-unsafe-inline[max_age]']").prop("disabled",!1),s("input[type='button'][name='no-unsafe-inline[add_new_endpoint]']").prop("disabled",!1),s("input[type='text'][name='no-unsafe-inline[new_endpoint]']").prop("disabled",!1),s(".nunil-btn-del-endpoint").prop("disabled",!1),s(".nunil-hidden-endpoint").prop("disabled",!1),s(".nunil-endpoint-string").removeClass("txt-inactive"),s(".nunil-endpoint-string").addClass("txt-active")):(s("input[type='text'][name='no-unsafe-inline[group_name]']").prop("disabled",!0),s("input[type='text'][name='no-unsafe-inline[max_age]']").prop("disabled",!0),s("input[type='button'][name='no-unsafe-inline[add_new_endpoint]']").prop("disabled",!0),s("input[type='text'][name='no-unsafe-inline[new_endpoint]']").prop("disabled",!0),s(".nunil-btn-del-endpoint").prop("disabled",!0),s(".nunil-hidden-endpoint").prop("disabled",!0),s(".nunil-endpoint-string").removeClass("txt-active"),s(".nunil-endpoint-string").addClass("txt-inactive"))}),s("#nunil-endpoints-list").on("click",".nunil-btn-del-endpoint",function(){s(this).closest("li").remove()}),s("input[type='text'][name='no-unsafe-inline[new_endpoint]']").on("focus",function(){s(this).removeClass("nunil-error-input")}),s("input[type='button'][name='no-unsafe-inline[add_new_endpoint]']").on("click",function(){var n;!function(n){var e;try{e=new URL(n)}catch(n){return}return"http:"===e.protocol||"https:"===e.protocol}(s("input[type='text'][name='no-unsafe-inline[new_endpoint]']").val())?s("input[type='text'][name='no-unsafe-inline[new_endpoint]']").addClass("nunil-error-input"):(n=s("input[type='text'][name='no-unsafe-inline[new_endpoint]']").val().trim(),s("#nunil-endpoints-list").append('<li><input  class="nunil-btn nunil-btn-del-endpoint" type="button" id="no-unsafe-inline[del-endpoint]['+e+']" name="no-unsafe-inline[del-endpoint]['+e+']" value="&#x2425;"><span class="nunil-endpoint-string txt-active txt-newly">'+n+'</span><input class="nunil-hidden-endpoint" type="hidden" id="no-unsafe-inline[endpoints]['+e+']"name="no-unsafe-inline[endpoints]['+e+']" value="'+n+'" /></li>'),s("input[type='text'][name='no-unsafe-inline[new_endpoint]']").val(""),s("input[type='text'][name='no-unsafe-inline[new_endpoint]']").removeClass("nunil-error-input"),e+=1)})),s("#nunil-db-sum-tabs").tabs({active:!1,classes:{"ui-tabs":"ui-corner-none","ui-tabs-nav":"ui-corner-none","ui-tabs-panel":"ui-corner-none","ui-tabs-tab":"ui-corner-none"},collapsible:!0}),s("#nunil_trigger_clustering").on("click",function(n){var e=s("#clustering_nonce").val();n.preventDefault(),s("#nunil_trigger_clustering").prop("disabled",!0),s.ajax({beforeSend:function(){s("#nunil-spinner-blocks").removeClass("hidden")},complete:function(){s("#nunil-spinner-blocks").addClass("hidden")},data:{action:"nunil_trigger_clustering",nonce:e},dataType:"json",success:function(n){"success"===n.type?(s("div#nunil_tools_operation_report").append(n.report),s("#nunil_trigger_clustering").prop("disabled",!1),u("once")):(s("div#nunil_tools_operation_report").append(p(!0)+r("Error in clustering scripts.","no-unsafe-inline")+"<br>"),s("#nunil_trigger_clustering").prop("disabled",!1)),s("#nunil_tools_operation_report").animate({scrollTop:s("#nunil_tools_operation_report").prop("scrollHeight")},1e3)},type:"post",url:nunil_object.ajax_url})}),s("#nunil_test_classifier").on("click",function(n){var e=s("#test_clussifier_nonce").val();n.preventDefault(),s("#nunil_test_classifier").prop("disabled",!0),s.ajax({beforeSend:function(){s("#nunil-spinner-blocks").removeClass("hidden")},complete:function(){s("#nunil-spinner-blocks").addClass("hidden")},data:{action:"nunil_test_classifier",nonce:e},dataType:"json",success:function(n){"success"===n.type?s("div#nunil_tools_operation_report").append(n.report):s("div#nunil_tools_operation_report").append(p(!0)+r("Error in test classifier scripts.","no-unsafe-inline")+"<br>"),s("#nunil_test_classifier").prop("disabled",!1),s("#nunil_tools_operation_report").animate({scrollTop:s("#nunil_tools_operation_report").prop("scrollHeight")},1e3)},type:"post",url:nunil_object.ajax_url})}),s("#nunil_clean_database").on("click",function(n){var e=s("#clean_db_nonce").val();if(!window.confirm(r("Are you sure you want to clean db data?\n(This will not clear your base rules)","no-unsafe-inline")))return!1;n.preventDefault(),s("#nunil_clean_database").prop("disabled",!0),s.ajax({beforeSend:function(){s("#nunil-spinner-blocks").removeClass("hidden")},complete:function(){s("#nunil-spinner-blocks").addClass("hidden")},data:{action:"nunil_clean_database",nonce:e},dataType:"json",success:function(n){"success"===n.type?(s("div#nunil_tools_operation_report").append(n.report),s("#nunil_clean_database").prop("disabled",!1),u("once")):(s("div#nunil_tools_operation_report").append(p(!0)+r("Error in cleaning tables.","no-unsafe-inline")+"<br>"),s("#nunil_clean_database").prop("disabled",!1)),s("#nunil_tools_operation_report").animate({scrollTop:s("#nunil_tools_operation_report").prop("scrollHeight")},1e3)},type:"post",url:nunil_object.ajax_url})}),s("#nunil_prune_database").on("click",function(n){var e=s("#prune_db_nonce").val();if(!window.confirm(r("Are you sure you want to prune db data?\n(This will reduce cluster size and remove orphans entries from occurences table)","no-unsafe-inline")))return!1;n.preventDefault(),s("#nunil_prune_database").prop("disabled",!0),s.ajax({beforeSend:function(){s("#nunil-spinner-blocks").removeClass("hidden")},complete:function(){s("#nunil-spinner-blocks").addClass("hidden")},data:{action:"nunil_prune_database",nonce:e},dataType:"json",success:function(n){"success"===n.type?(s("div#nunil_tools_operation_report").append(n.report),s("#nunil_prune_database").prop("disabled",!1),u("once")):(s("div#nunil_tools_operation_report").append(p(!0)+r("Error in pruning tables.","no-unsafe-inline")+"<br>"),s("#nunil_prune_database").prop("disabled",!1)),s("#nunil_tools_operation_report").animate({scrollTop:s("#nunil_tools_operation_report").prop("scrollHeight")},1e3)},type:"post",url:nunil_object.ajax_url})}),"no-unsafe-inline"!==i||"tools"!==o&&null!==o&&!1!==o||(s("input#submit").prop("disabled",!0),s("input[type='checkbox'][name='no-unsafe-inline-tools[capture_enabled]']").prop("checked")&&u()),s("input[type='checkbox'][name='no-unsafe-inline-tools[capture_enabled]']").on("change",function(){var n=s(this);s("input#submit").prop("disabled",!1),n.prop("checked")&&u()}),s("input[type='checkbox'][name='no-unsafe-inline-tools[test_policy]']").on("change",function(){var n=s(this);s("input#submit").prop("disabled",!1),n.prop("checked")&&s("input[type='checkbox'][name='no-unsafe-inline-tools[enable_protection]']").prop("checked",!1)}),s("input[type='checkbox'][name='no-unsafe-inline-tools[enable_protection]']").on("change",function(){var n=s(this);s("input#submit").prop("disabled",!1),n.prop("checked")&&s("input[type='checkbox'][name='no-unsafe-inline-tools[test_policy]']").prop("checked",!1)})});